<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>財務管理 - 訂單收入記錄</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    
    <!-- 自定義配置（統一範例圖的綠色系） -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#00C300', // 主色（範例圖的綠色）
                        secondary: '#00A600', // 次要綠色
                        accent: '#008700', // 深綠色
                        success: '#00B42A',
                        warning: '#FF7D00',
                        danger: '#F53F3F',
                        neutral: {
                            100: '#F2F3F5',
                            200: '#E5E6EB',
                            300: '#C9CDD4',
                            400: '#86909C',
                            500: '#4E5969',
                            600: '#272E3B',
                            700: '#1D2129',
                        }
                    },
                    fontFamily: {
                        sans: ['Microsoft JhengHei', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 2px 14px 0 rgba(0, 0, 0, 0.06)',
                        'hover': '0 6px 16px 0 rgba(0, 0, 0, 0.08)',
                    }
                },
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-transition {
                transition: all 0.3s ease;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            /* 左側菜單樣式（與範例圖一致） */
            .sidebar-menu {
                background: #fff;
                border-right: 1px solid #e6e6e6;
            }
            .sidebar-menu a {
                @apply flex items-center gap-2 py-3 px-4 text-neutral-600 hover:bg-primary/10 hover:text-primary transition-all;
            }
            .sidebar-menu a.active {
                @apply bg-primary text-white;
            }
        }
    </style>
</head>
<body class="bg-neutral-100 font-sans text-neutral-700 min-h-screen flex">
    <!-- 左側菜單（修正所有連結路徑） -->
    <aside class="sidebar-menu w-56 h-screen sticky top-0">
        <div class="py-4 px-4 border-b border-neutral-200">
            <h2 class="font-bold text-lg text-neutral-700">LINE多元化搭車管理員</h2>
        </div>
        <nav>
            <a href="admin-dashboard.html" class="flex items-center gap-2">
                <<<i class="fa fa-home"></</</i>
                <span>首頁</span>
            </a>
            <a href="admin-area.html" class="flex items-center gap-2">
                <<<i class="fa fa-map-marker"></</</i>
                <span>區域管理</span>
            </a>
            <a href="admin-driver.html" class="flex items-center gap-2">
                <<<i class="fa fa-car"></</</i>
                <span>司機管理</span>
            </a>
            <a href="admin-order.html" class="flex items-center gap-2">
                <<<i class="fa fa-list"></</</i>
                <span>訂單管理</span>
            </a>
            <a href="finance-management.html" class="flex items-center gap-2 active">
                <<<i class="fa fa-money"></</</i>
                <span>財務管理</span>
            </a>
            <a href="admin-report.html" class="flex items-center gap-2">
                <<<i class="fa fa-bar-chart"></</</i>
                <span>報表統計</span>
            </a>
            <a href="../managerindex.html" class="flex items-center gap-2 mt-4">
                <<<i class="fa fa-sign-out"></</</i>
                <span>退出登入</span>
            </a>
        </nav>
    </aside>

    <!-- 主內容區（優化排版結構） -->
    <div class="flex-1 flex flex-col">
        <!-- 頂部導航欄 -->
        <header class="bg-white shadow-sm sticky top-0 z-50">
            <div class="container mx-auto px-4 py-3 flex flex-wrap items-center justify-between gap-4">
                <div class="flex items-center gap-2">
                    <<<i class="fa fa-line-chart text-primary text-2xl"></</</i>
                    <h1 class="text-xl font-bold text-neutral-700">財務管理系統</h1>
                </div>
                <div class="flex items-center gap-4">
                    <div class="relative">
                        <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                            <<<i class="fa fa-calendar text-neutral-400"></</</i>
                        </span>
                        <input type="date" id="startDate" class="bg-neutral-100 border border-neutral-200 text-neutral-700 rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all" placeholder="開始日期">
                    </div>
                    <div class="relative">
                        <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                            <<<i class="fa fa-calendar text-neutral-400"></</</i>
                        </span>
                        <input type="date" id="endDate" class="bg-neutral-100 border border-neutral-200 text-neutral-700 rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all" placeholder="結束日期">
                    </div>
                    <button id="searchBtn" class="bg-primary hover:bg-primary/90 text-white rounded-lg py-2 px-6 flex items-center gap-2 transition-all focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2">
                        <<<i class="fa fa-search"></</</i>
                        <span>查詢</span>
                    </button>
                </div>
            </div>
        </header>

        <main class="container mx-auto px-4 py-6 flex-1">
            <!-- 收入統計卡片區域 -->
            <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- 本日收入 -->
                <div class="bg-white rounded-xl shadow-card p-6 card-transition hover:shadow-hover">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h2 class="text-neutral-500 font-medium">本日收入</h2>
                            <p class="text-3xl font-bold text-neutral-700 mt-2" id="todayTotal">NT$ 0</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center">
                            <<<i class="fa fa-sun-o text-primary text-xl"></</</i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <span class="text-success flex items-center">
                            <<<i class="fa fa-arrow-up mr-1"></</</i>
                            <span id="todayGrowth">0%</span>
                        </span>
                        <span class="text-neutral-400 ml-2">較昨日</span>
                    </div>
                </div>

                <!-- 本周收入 -->
                <div class="bg-white rounded-xl shadow-card p-6 card-transition hover:shadow-hover">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h2 class="text-neutral-500 font-medium">本周收入</h2>
                            <p class="text-3xl font-bold text-neutral-700 mt-2" id="weekTotal">NT$ 0</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-secondary/10 flex items-center justify-center">
                            <<<i class="fa fa-calendar-week text-secondary text-xl"></</</i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <span class="text-success flex items-center">
                            <<<i class="fa fa-arrow-up mr-1"></</</i>
                            <span id="weekGrowth">0%</span>
                        </span>
                        <span class="text-neutral-400 ml-2">較上周</span>
                    </div>
                </div>

                <!-- 本月收入 -->
                <div class="bg-white rounded-xl shadow-card p-6 card-transition hover:shadow-hover">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h2 class="text-neutral-500 font-medium">本月收入</h2>
                            <p class="text-3xl font-bold text-neutral-700 mt-2" id="monthTotal">NT$ 0</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-accent/10 flex items-center justify-center">
                            <<<i class="fa fa-calendar text-accent text-xl"></</</i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <span class="text-success flex items-center">
                            <<<i class="fa fa-arrow-up mr-1"></</</i>
                            <span id="monthGrowth">0%</span>
                        </span>
                        <span class="text-neutral-400 ml-2">較上月</span>
                    </div>
                </div>
            </section>

            <!-- 收入趨勢圖 -->
            <section class="bg-white rounded-xl shadow-card p-6 mb-8 card-transition">
                <h2 class="text-lg font-bold text-neutral-700 mb-4">收入趨勢</h2>
                <div class="h-80">
                    <canvas id="revenueChart"></canvas>
                </div>
            </section>

            <!-- 訂單列表 -->
            <section class="bg-white rounded-xl shadow-card p-6 card-transition">
                <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
                    <h2 class="text-lg font-bold text-neutral-700">訂單收入記錄</h2>
                    <div class="flex gap-2">
                        <button id="exportBtn" class="bg-success hover:bg-success/90 text-white rounded-lg py-2 px-4 flex items-center gap-2 transition-all focus:outline-none focus:ring-2 focus:ring-success/50 focus:ring-offset-2">
                            <<<i class="fa fa-download"></</</i>
                            <span>匯出Excel</span>
                        </button>
                        <button id="refreshBtn" class="bg-neutral-200 hover:bg-neutral-300 text-neutral-700 rounded-lg py-2 px-4 flex items-center gap-2 transition-all focus:outline-none focus:ring-2 focus:ring-neutral-400/50 focus:ring-offset-2">
                            <<<i class="fa fa-refresh"></</</i>
                            <span>刷新</span>
                        </button>
                    </div>
                </div>

                <!-- 訂單表格 -->
                <div class="overflow-x-auto scrollbar-hide">
                    <table class="w-full min-w-[800px]">
                        <thead>
                            <tr class="border-b border-neutral-200">
                                <<<th class="text-left py-4 px-4 text-neutral-500 font-medium">訂單編號</</</th>
                                <<<th class="text-left py-4 px-4 text-neutral-500 font-medium">訂單日期</</</th>
                                <<<th class="text-left py-4 px-4 text-neutral-500 font-medium">客戶名稱</</</th>
                                <<<th class="text-right py-4 px-4 text-neutral-500 font-medium">訂單金額</</</th>
                                <<<th class="text-center py-4 px-4 text-neutral-500 font-medium">付款狀態</</</th>
                                <<<th class="text-center py-4 px-4 text-neutral-500 font-medium">操作</</</th>
                            </tr>
                        </thead>
                        <tbody id="orderTableBody">
                            <!-- 訂單數據將通過JS動態加載 -->
                            <tr class="border-b border-neutral-100">
                                <td colspan="6" class="py-8 text-center text-neutral-400">
                                    <<<i class="fa fa-inbox text-3xl mb-2"></</</i>
                                    <p>暫無訂單數據</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 分頁控制 -->
                <div class="flex flex-wrap justify-between items-center mt-6 gap-4">
                    <div class="text-neutral-500 text-sm">
                        顯示 <span id="showingCount">0</span> 筆，共 <span id="totalCount">0</span> 筆
                    </div>
                    <div class="flex gap-2">
                        <button class="w-10 h-10 rounded-lg border border-neutral-200 flex items-center justify-center text-neutral-700 hover:bg-primary hover:text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed" id="prevPage" disabled>
                            <<<i class="fa fa-chevron-left"></</</i>
                        </button>
                        <button class="w-10 h-10 rounded-lg border border-neutral-200 flex items-center justify-center text-neutral-700 hover:bg-primary hover:text-white transition-all bg-primary text-white" id="page1">1</button>
                        <button class="w-10 h-10 rounded-lg border border-neutral-200 flex items-center justify-center text-neutral-700 hover:bg-primary hover:text-white transition-all" id="page2">2</button>
                        <button class="w-10 h-10 rounded-lg border border-neutral-200 flex items-center justify-center text-neutral-700 hover:bg-primary hover:text-white transition-all" id="page3">3</button>
                        <button class="w-10 h-10 rounded-lg border border-neutral-200 flex items-center justify-center text-neutral-700 hover:bg-primary hover:text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed" id="nextPage">
                            <<<i class="fa fa-chevron-right"></</</i>
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- 頁腳 -->
        <footer class="bg-white border-t border-neutral-200 mt-8 py-6">
            <div class="container mx-auto px-4 text-center text-neutral-500 text-sm">
                <p>© 2025 LINE多元化搭車管理員 - 所有權利保留</p>
            </div>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        // 模擬數據
        const mockOrders = [
            { id: 'ORD20250501001', date: '2025-05-01', customer: '張三', amount: 1500, status: '已付款' },
            { id: 'ORD20250501002', date: '2025-05-01', customer: '李四', amount: 2800, status: '已付款' },
            { id: 'ORD20250502001', date: '2025-05-02', customer: '王五', amount: 950, status: '已付款' },
            { id: 'ORD20250503001', date: '2025-05-03', customer: '趙六', amount: 4200, status: '未付款' },
            { id: 'ORD20250504001', date: '2025-05-04', customer: '錢七', amount: 1800, status: '已付款' },
            { id: 'ORD20250505001', date: '2025-05-05', customer: '孫八', amount: 3500, status: '已付款' },
            { id: 'ORD20250506001', date: '2025-05-06', customer: '周九', amount: 2200, status: '已付款' },
            { id: 'ORD20250507001', date: '2025-05-07', customer: '吳十', amount: 1750, status: '已付款' },
            { id: 'ORD20250508001', date: '2025-05-08', customer: '鄭十一', amount: 3100, status: '已付款' },
            { id: 'ORD20250509001', date: '2025-05-09', customer: '王十二', amount: 980, status: '未付款' },
        ];

        // 統計數據
        const todayTotal = 4300;
        const weekTotal = 22600;
        const monthTotal = 89500;
        const todayGrowth = 12.5;
        const weekGrowth = 8.3;
        const monthGrowth = 15.7;

        // 初始化頁面
        document.addEventListener('DOMContentLoaded', function() {
            // 設置統計數據
            document.getElementById('todayTotal').textContent = `NT$ ${todayTotal.toLocaleString()}`;
            document.getElementById('weekTotal').textContent = `NT$ ${weekTotal.toLocaleString()}`;
            document.getElementById('monthTotal').textContent = `NT$ ${monthTotal.toLocaleString()}`;
            document.getElementById('todayGrowth').textContent = `${todayGrowth}%`;
            document.getElementById('weekGrowth').textContent = `${weekGrowth}%`;
            document.getElementById('monthGrowth').textContent = `${monthGrowth}%`;

            // 渲染訂單表格
            renderOrderTable(mockOrders);

            // 初始化圖表
            initRevenueChart();

            // 設置按鈕事件
            setupButtonEvents();

            // 設置當前日期
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('startDate').value = formattedDate;
            document.getElementById('endDate').value = formattedDate;
        });

        // 渲染訂單表格
        function renderOrderTable(orders) {
            const tableBody = document.getElementById('orderTableBody');
            tableBody.innerHTML = '';

            if (orders.length === 0) {
                tableBody.innerHTML = `
                    <tr class="border-b border-neutral-100">
                        <td colspan="6" class="py-8 text-center text-neutral-400">
                            <<<i class="fa fa-inbox text-3xl mb-2"></</</i>
                            <p>暫無訂單數據</p>
                        </td>
                    </tr>
                `;
                document.getElementById('showingCount').textContent = '0';
                document.getElementById('totalCount').textContent = '0';
                return;
            }

            orders.forEach(order => {
                const tr = document.createElement('tr');
                tr.className = 'border-b border-neutral-100 hover:bg-neutral-50 transition-all';
                
                // 狀態樣式
                let statusClass = '';
                let statusText = '';
                if (order.status === '已付款') {
                    statusClass = 'bg-success/10 text-success';
                    statusText = '已付款';
                } else {
                    statusClass = 'bg-danger/10 text-danger';
                    statusText = '未付款';
                }

                tr.innerHTML = `
                    <td class="py-4 px-4 font-medium">${order.id}</td>
                    <td class="py-4 px-4 text-neutral-600">${order.date}</td>
                    <td class="py-4 px-4 text-neutral-600">${order.customer}</td>
                    <td class="py-4 px-4 text-right font-medium">NT$ ${order.amount.toLocaleString()}</td>
                    <td class="py-4 px-4 text-center">
                        <span class="px-3 py-1 rounded-full text-xs ${statusClass}">${statusText}</span>
                    </td>
                    <td class="py-4 px-4 text-center">
                        <button class="text-primary hover:text-primary/80 transition-colors">
                            <<<i class="fa fa-eye"></</</i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(tr);
            });

            document.getElementById('showingCount').textContent = orders.length;
            document.getElementById('totalCount').textContent = orders.length;
        }

        // 初始化收入趨勢圖
        function initRevenueChart() {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            
            // 模擬過去14天的數據
            const labels = Array.from({length: 14}, (_, i) => {
                const date = new Date();
                date.setDate(date.getDate() - 13 + i);
                return `${date.getMonth() + 1}/${date.getDate()}`;
            });
            
            const data = [
                1200, 1900, 3000, 5000, 2800, 3500, 4200,
                3800, 4500, 3200, 2800, 4100, 4800, 5200
            ];

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '每日收入 (NT$)',
                        data: data,
                        backgroundColor: 'rgba(0, 195, 0, 0.1)',
                        borderColor: '#00C300',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: '#FFFFFF',
                        pointBorderColor: '#00C300',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            padding: 10,
                            cornerRadius: 8,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return `收入: NT$ ${context.raw.toLocaleString()}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return 'NT$ ' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // 設置按鈕事件
        function setupButtonEvents() {
            // 查詢按鈕
            document.getElementById('searchBtn').addEventListener('click', function() {
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                
                if (!startDate || !endDate) {
                    alert('請選擇開始日期和結束日期');
                    return;
                }
                
                // 模擬查詢效果
                this.innerHTML = '<<<i class="fa fa-spinner fa-spin"></</</i><span>查詢中...</span>';
                this.disabled = true;
                
                setTimeout(() => {
                    // 過濾訂單數據
                    const filteredOrders = mockOrders.filter(order => {
                        return order.date >= startDate && order.date <= endDate;
                    });
                    
                    renderOrderTable(filteredOrders);
                    
                    this.innerHTML = '<<<i class="fa fa-search"></</</i><span>查詢</span>';
                    this.disabled = false;
                }, 800);
            });

            // 匯出按鈕
            document.getElementById('exportBtn').addEventListener('click', function() {
                alert('Excel匯出功能已觸發，實際專案中可整合SheetJS等庫實現');
            });

            // 刷新按鈕
            document.getElementById('refreshBtn').addEventListener('click', function() {
                this.innerHTML = '<<<i class="fa fa-spinner fa-spin"></</</i><span>刷新中...</span>';
                
                setTimeout(() => {
                    renderOrderTable(mockOrders);
                    this.innerHTML = '<<<i class="fa fa-refresh"></</</i><span>刷新</span>';
                }, 600);
            });

            // 分頁按鈕示例
            const pageButtons = [document.getElementById('page1'), document.getElementById('page2'), document.getElementById('page3')];
            pageButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    pageButtons.forEach(b => {
                        b.classList.remove('bg-primary', 'text-white');
                        b.classList.add('text-neutral-700');
                    });
                    this.classList.add('bg-primary', 'text-white');
                    this.classList.remove('text-neutral-700');
                });
            });

            // 上一頁/下一頁按鈕
            document.getElementById('prevPage').addEventListener('click', function() {
                alert('上一頁功能');
            });
            
            document.getElementById('nextPage').addEventListener('click', function() {
                alert('下一頁功能');
            });
        }
    </script>
</body>
</html>